# pm3 Lumped Parameter Cerebral Code 2021

License:
GNU GENERAL PUBLIC LICENSE Version 3

30 December 2021.

Authors:
Timothy J. Hunter, Jermiah J. Joseph, Udunna Anazodo, Sanjay R. Kharche, Christopher W. McIntyre, Daniel Goldman.

This code is associated with submission entitled: "Computational Modelling of the Role of Atrial Fibrillation on Cerebral Blood Perfusion"

DOI: (coming soon).

Code description:
This code contains lumped parameter model capable of simulating whole body blood flow with detailed cerebral circulation and a baroreflex control mechanism. It works as a system of stiff ODEs that is solved using the SUNDIALS library CVODE solver.

Inputs: The binary requires 3 integer inputs to run on the command line, e.g.

```
./cbf 0 1 1
```

Input 1: indicates the instance number, which is used in reading parameter and random noise files, as well as to number the output files.
Input 2: is either 0 or 1. 0 indicates control conditions, 1 indicates Atrial fibrilation conditions.
Input 3: is an integer from 0 - 5. This indicates which CoW variant will be simulated. See published article for info on CoW variants.

input files: 3 files are required to be in a directory named input in the directory that the program is executed.
File 1: expNoise.dat  
File 2: pinkNoise.dat  
File 3: randomPars.dat
This directory and these files can be automatically generated by executing the matlab functions defined in makeNoiseSamples.m and makeRandomPars.m, with the argument n being the total number of instances to be generated.

Outputs: This code generates 3 output files per instance, titled endDiastolicTime.{instance}.{case}.dat, parameters.{instance}.dat and statesOutput.{instance}.{case}.dat
with {instance} being the instance number, and case being either NSR or AF.
endDiastolicTime.{instance}.{case}.dat: contains the initial time of every cardiac cycle for the duration of the simulation.
parameters.{instance}.dat: contains a list of all model parameters after being modulated by randomPars.dat
statesOutput.{instance}.{case}.dat: contains the time-dependent model outputs in the following column order, time P_a q_ml q_al q_pl q_mr q_ar q_pr

References.

Heldt, T. Computational models of cardiovascular response to orthostatic stress. 2004, 185.

Ursino, M.; Giannessi, M. A model of cerebrovascular reactivity including the circle of Willis and cortical anastomoses. Ann. Biomed. Eng. 2010, 38, 955–974, doi:10.1007/S10439-010-9923-7/TABLES/2.

Lin, J.; Ngwompo, R.F.; Tilley, D.G. Development of a cardiopulmonary mathematical model incorporating a baro-chemoreceptor reflex control system. Proc. Inst. Mech. Eng. Part H J. Eng. Med. 2012, 226, 787–803, doi:10.1177/0954411912451823.

Scarsoglio, S.; Guala, A.; Camporeale, C.; Ridolfi, L. Impact of atrial fibrillation on the cardiovascular system through a lumped-parameter approach. Med. Biol. Eng. Comput. 2014, 52, 905–920, doi:10.1007/S11517-014-1192-4.
